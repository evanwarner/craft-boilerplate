{#
  Default response headers. Any individual hash key can be overridden in a
  child template.

  TODO: set directives appropriate for the project
 #}
{% set cspDirectives = {
  'default-src': '\'self\'',
  'script-src': '\'self\' \'unsafe-inline\'',
  'style-src': '\'self\' \'unsafe-inline\'',
  'object-src': '\'none\'',
  'form-action': '\'self\'',
  'frame-ancestors': '\'self\'',
 } | merge(cspDirectives ?? {}) %}

{% set headers = {
  'Content-Security-Policy': cspDirectives,
} | merge(headers ?? {}) %}

{% for headerName, value in headers %}
  {% if value is iterable %}
    {% set directives = [] %}
    {% for directive, directiveValue in value %}
      {% set directives = directives | merge([directive ~ ' ' ~ directiveValue]) %}
    {% endfor %}
    {% set value = directives | join('; ') %}
  {% endif %}
  {% header headerName ~ ': ' ~ value %}
{% endfor %}



<!DOCTYPE html>
<html class="no-js" lang="{{ currentSite.language|slice(0, 2) }}">
<head prefix="og: http://ogp.me/ns#">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  {# TODO: meta titles #}
  {% if entry is defined and entry.type == 'homepage' %}
    {% set metaTitle = siteName %}
  {% else %}
    {% set metaTitle = (metaTitle ?? displayTitle ?? entry.title ?? '') ~ ' | ' ~ siteName %}
  {% endif %}
  <title>{{ metaTitle }}</title>

  {# TODO: meta descriptions #}
  {% set metaDescription = metaDescription ?? '' %}
  <meta name="description" content="{{ metaDescription }}">

  {% block referrer %}
    <meta name="referrer" content="unsafe-url">
  {% endblock %}
  <meta name="format-detection" content="telephone=no">

  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ craft.app.request.absoluteUrl }}">
  <meta property="og:site_name" content="{{ siteName }}">
  <meta property="og:title" content="{{ metaTitle }}">
  <meta property="og:description" content="{{ metaDescription }}">
  <meta property="og:locale" content="{{ currentSite.language|slice(0, 2) }}">
  <meta property="og:image" content="">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="">
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">

  <meta name="apple-mobile-web-app-title" content="{{ siteName }}">
  <link rel="apple-touch-icon" sizes="180x180" href="/icon-180.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/icon-167.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon-152.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon-120.png">

  <meta name="msapplication-config" content="/ieconfig.xml">

  <meta name="theme-color" content="#FFF">

  <script type="text/javascript">
    !function() {
      var h = document.documentElement.classList;
      h.remove('no-js');
      h.add('js');
    }();
  </script>

  <link rel="stylesheet" href="{{ rev('css/main.css') }}" media="screen">
  {{ head() }}
</head>
{% set bodyClasses = bodyClasses|default([]) %}
{% if entry is defined %}
  {% set bodyClasses = bodyClasses|merge([entry.type|ucfirst ~ 'Page']) %}
{% endif %}
<body class="{{ bodyClasses|unique|join(' ') }}">
  {{ beginBody() }}
  <a class="SkipLink u-visuallyHidden u-focusable" href="#main-content" title="Jump to the main page content">Skip to content</a>

  <main id="main-content">
    {% block content %}{% endblock %}
  </main>

  <script src="{{ rev('js/main.js') }}"></script>
  {{ endBody() }}
  <link rel="stylesheet" href="{{ rev('css/print.css') }}" media="print">
</body>
</html>
